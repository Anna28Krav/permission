<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>–ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import { getFirestore, collection, getDocs, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";
    import { firebaseConfig } from './firebase-config.js';

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const table = document.getElementById("requestsTable");

    async function loadRequests() {
      const snapshot = await getDocs(collection(db, "admin_requests"));
      table.innerHTML = "<tr><th>Email</th><th>–î–∞—Ç–∞ –∑–∞–ø–∏—Ç—É</th><th>–î—ñ—è</th></tr>";
      snapshot.forEach(docSnap => {
        const data = docSnap.data();
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${data.email}</td>
          <td>${new Date(data.requestedAt).toLocaleString()}</td>
          <td>
            <button onclick="approve('${data.email}', '${docSnap.id}')">‚úÖ –°—Ö–≤–∞–ª–∏—Ç–∏</button>
            <button onclick="decline('${docSnap.id}')">‚ùå –í—ñ–¥—Ö–∏–ª–∏—Ç–∏</button>
          </td>`;
        table.appendChild(tr);
      });
    }

    window.approve = async function(email, requestId) {
      alert(`–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∑ email ${email} –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–¥–∞—Ç–∏ —á–µ—Ä–µ–∑ Firebase Console –≤—Ä—É—á–Ω—É.`);
      await deleteDoc(doc(db, "admin_requests", requestId));
      loadRequests();
    }

    window.decline = async function(requestId) {
      await deleteDoc(doc(db, "admin_requests", requestId));
      loadRequests();
    }

    loadRequests();
  </script>
  <style>
    body { font-family: Arial; background: #111; color: white; padding: 20px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #555; padding: 8px; text-align: left; }
    th { background-color: #222; }
    button { margin: 2px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>üìã –ó–∞–ø–∏—Ç–∏ –Ω–∞ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä—É–≤–∞–Ω–Ω—è</h1>
  <table id="requestsTable">
    <tr><th>Email</th><th>–î–∞—Ç–∞ –∑–∞–ø–∏—Ç—É</th><th>–î—ñ—è</th></tr>
  </table>
</body>
</html>
